# Настройка электронных чеков в IIKO

## Принцип работы

1. Клиент при оформлении заказа в приложении выбирает получить чек на Email.

3. Приложение передаёт в IIKO данные: "печатный чек не нужен" и Email клиента.

5. Фискальный регистратор отправляет кленту электронный чек через оператор фискальных данных (ОФД).

> Чек отправляет именно фискальный регистратор, а не IIKO или приложение. Настройка в IIKO проводится для того, чтобы клиенту был доступен выбор способа получения чека.

Пример отображения

![](https://github.com/evhold/tech-writer-portfolio/blob/main/images/guide-e-receipts-1.png)

Если клиент выбирает электронный чек, то приложение передаёт в IIKO адрес электронной почты клиента и параметр: 

```
"chequeAdditionalInfo": {
	    "needReceipt": false,
```

Это означает "печатный чек не нужен", что служит для системы сигналом об отправке чека на Email. 

Если клиент выбирает печатный чек, то приложение передаёт в IIKO параметр: 

```
"chequeAdditionalInfo": {
	     "needReceipt": true,
```

Это означает "нужен печатный чек".

## Необходимо для подключения

1. Интеграция по протоколу iikoTransport.

2. Заключен договор с оператором фискальных данных. К примеру – ОФД Taxcom, OFD.RU, Эвотор ОФД, Платформа ОФД.

3. Фискальный регистратор не виртуальный.

## Шаги настройки в IIKO

В IIKO необходимо включить выбор способа отправки чека. Настройка находится в разделе "Администрирование" и проводится для каждого отделения, в котором есть столы. 

1. Перейти в раздел "Администрирование", вкладка "Настройки торгового предприятия".

![](https://github.com/evhold/tech-writer-portfolio/blob/main/images/guide-e-receipts-2.png)

2. Нажать ЛКМ на названии отделения, для которого производится настройка. Отделениями называются зоны в ресторане – бар, пицца, суши и т. д.

![](https://github.com/evhold/tech-writer-portfolio/blob/main/images/guide-e-receipts-3.png)

3. В поле "Способ отправки чека" выбрать вариант "Запрос при оплате".

![](https://github.com/evhold/tech-writer-portfolio/blob/main/images/guide-e-receipts-4.png)

4. Нажать кнопку "Сохранить изменения".

5. Повторить настройку для остальных отделений.

> По умолчанию в настройках отделения задана настройка "Печать чека", так как не во всех ресторанах у кассы есть доступ в интернет.
>
> Настройка "Запрос при оплате" позволяет выбирать способ передачи чека при оплате заказа. 
